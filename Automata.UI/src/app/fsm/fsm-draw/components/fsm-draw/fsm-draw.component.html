<div class='row' style='margin:0;'>
  <div [ngClass]='{"col-md-9":!readonly,"col-md-12": readonly}' style='padding:0;'>
    <div class='scroll-container' [style.height]='height' oncontextmenu='return false'>
      <div class='draw-container bg-drawing' [style.height.px]='scrollsize' [style.width.px]='scrollsize'>      
        <app-fsm-draw-surface [zoomPercent]='zoomPercent' (surfaceclick)='onSurfaceClick($event)' (surfacemousedown)='onSurfaceMouseDown($event)' (surfacemousemove)='onSurfaceMouseMove($event)'
          (surfacecontextmenu)='onSurfaceContextMenu($event)'>


          <!--Draw transitions-->
          <ng-template ngFor let-item [ngForOf]='fsmSvc.fsmTransitions'>
            <svg:g app-fsm-draw-transition [transition]='item' [selected]='selected && selected===item' />
          </ng-template>
          <!--Draw states-->
          <ng-template ngFor let-item [ngForOf]='fsmSvc.fsmStates'>
            <svg:g app-fsm-draw-state [state]='item' [selected]='selected && selected===item' />
          </ng-template>

          <!--Transition creating-endpoint not selected yet-->
          <ng-template [ngIf]='transitionSelectedState'>
            <svg:g app-fsm-draw-transition [transition]='startTransition(mouseX,mouseY)' />
          </ng-template>

        </app-fsm-draw-surface>

      </div>  
    </div>
  </div>

  <div *ngIf='!readonly' class='col-md-3' style='overflow:hidden;width:100%;padding:0'>
    <app-fsm-draw-props [object]='selected'></app-fsm-draw-props>
  </div>
</div>

<app-fsm-draw-controlbar [readonly]='readonly' (clear)='onCtrlbarClear()' (help)='onCtrlbarHelp()' (mode)='onCtrlbarMode($event)'
  (validate)='onCtrlbarValidate()' (zoom)='onCtrlbarZoom($event)'>
</app-fsm-draw-controlbar>

<!--State context menu -->
<app-context-menu [open]='stateContextOpen'>
  <app-context-menu-item (itemclick)='onStateContextClickDelete($event)'>
    Delete
  </app-context-menu-item>
  <app-context-menu-item divider='true'></app-context-menu-item>
  <app-context-menu-item (itemclick)='onStateContextClickStart($event)' [checked]='stateContextOpen && (stateContextOpen.obj.stateType==="start"|| stateContextOpen.obj.stateType==="startfinal") '>
    Start State
  </app-context-menu-item>
  <app-context-menu-item (itemclick)='onStateContextClickFinal($event)' [checked]='stateContextOpen && (stateContextOpen.obj.stateType==="final"|| stateContextOpen.obj.stateType==="startfinal")'>
    Final State
  </app-context-menu-item>
</app-context-menu>

<!--Transition context menu-->
<app-context-menu [open]='transContextOpen'>
  <app-context-menu-item (itemclick)='onTransContextClickDelete($event)'>
    Delete
  </app-context-menu-item>
</app-context-menu>