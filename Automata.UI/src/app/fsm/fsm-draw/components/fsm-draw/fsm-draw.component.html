<div class='flex-height-container'>
  <div class='flex-height-child flex-height-container'>
    <div class='row flex-height-child margin-0'>

      <div class='pad0' [ngClass]='{"col-md-9":!readonly,"col-md-12": readonly}'  >
        <div class='scroll-container' oncontextmenu='return false'>
          <app-fsm-draw-surface [ngClass]='cursor' [zoomPercent]='zoomPercent' (surfaceclick)='onSurfaceClick($event)' (surfacemousedown)='onSurfaceMouseDown($event)'
            (surfacemousemove)='onSurfaceMouseMove($event)' (surfacecontextmenu)='onSurfaceContextMenu($event)'>
            <ng-template ngFor let-item [ngForOf]='getTransitions()'>
              <svg:g app-fsm-draw-transition [transition]='item' [selected]='selected && selected===item' />
            </ng-template>
            <ng-template [ngIf]='transitionSelectedState'>
              <svg:g app-fsm-draw-transition [transition]='startTransition' />
            </ng-template>
            <ng-template ngFor let-item [ngForOf]='getStates()'>
              <svg:g app-fsm-draw-state [state]='item' [selected]='selected && selected===item' />
            </ng-template>
          </app-fsm-draw-surface>
        </div>
      </div>
      <div *ngIf='!readonly' class='col-md-3 pad0'>
        <app-fsm-draw-props [object]='selected'></app-fsm-draw-props>
      </div>
    </div>

  </div>


  <div #cbar class='bg-light'>
    <div class='container-fluid'>
      <div class='row'>
        <div class='col-md-9 pad0'>
          <app-fsm-draw-controlbar [readonly]='readonly' [isValid]='isValid' (newfile)='onCtrlbarNew()' (loadfile)='onCtrlbarLoad()'
            (savefile)='onCtrlbarSave()' (mode)='onCtrlbarMode($event)' (zoom)='onCtrlbarZoom($event)' (saveimage)='onCtrlbarExport()'></app-fsm-draw-controlbar>
        </div>
        <div class='col-md-3 border-top border-left bigfont w-100' [ngbTooltip]='statusTooltip' style='padding:.6rem'>
          FSM Type:
          <span [hidden]='statusTooltip===""' class='littlefont'>(Hover for more)</span>
          <div class='font-weight-bold midfont' [ngClass]='{"text-danger":status==="Invalid"}' >{{status}}</div>
        </div>
      </div>
    </div>
  </div>

</div>

<!--State context menu -->
<app-context-menu [open]='stateContextOpen'>
  <app-context-menu-item (itemclick)='onStateContextClickDelete($event)'>
    Delete
  </app-context-menu-item>
  <app-context-menu-item divider='true'></app-context-menu-item>
  <app-context-menu-item (itemclick)='onStateContextClickStart($event)' [checked]='stateContextOpen && (stateContextOpen.obj.stateType==="start"|| stateContextOpen.obj.stateType==="startfinal") '>
    Start State
  </app-context-menu-item>
  <app-context-menu-item (itemclick)='onStateContextClickFinal($event)' [checked]='stateContextOpen && (stateContextOpen.obj.stateType==="final"|| stateContextOpen.obj.stateType==="startfinal")'>
    Final State
  </app-context-menu-item>
</app-context-menu>

<!--Transition context menu-->
<app-context-menu [open]='transContextOpen'>
  <app-context-menu-item (itemclick)='onTransContextClickDelete($event)'>
    Delete
  </app-context-menu-item>
</app-context-menu>
<app-alert-modal (modalclose)='onmodalclose($event)'></app-alert-modal>
<app-file-io type='text' (file)='onIoFileUpload($event)'> </app-file-io>